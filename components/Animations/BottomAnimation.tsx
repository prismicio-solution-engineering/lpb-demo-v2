"use client";

import { useScroll, motion, useTransform, useSpring } from "framer-motion";
import { useRef } from "react";

export const BottomAnimation = () => {
  const scrollTarget = useRef(null);

  const { scrollYProgress } = useScroll({
    target: scrollTarget,
    offset: [`end end`, `start start`],
  });

  // Transform scroll progress to ball position
  // Adjusted scroll progress values to better match position percentages
  const ballX = useTransform(
    scrollYProgress,
    [0, 0.15, 0.2, 0.3, 0.35, 0.4, 0.45, 0.55, 0.7, 0.75, 1.0],
    [
      "-5%",
      "15%",
      "21.5%",
      "36.7%",
      "42%",
      "48.8%",
      "54%",
      "65.8%",
      "85%",
      "90%",
      "100%",
    ]
  );

  const ballY = useTransform(
    scrollYProgress,
    [0, 0.15, 0.2, 0.3, 0.35, 0.4, 0.45, 0.55, 0.7, 0.75, 1.0],
    [
      "-11%",
      "34%",
      "19%",
      "49%",
      "40%",
      "53%",
      "44%",
      "71%",
      "30%",
      "40%",
      "16%",
    ]
  );

  const ballColor = useTransform(
    scrollYProgress,
    [0, 0.39, 0.41, 0.63, 0.65, 1],
    ["#8E44EC", "#8E44EC", "#59B5F8", "#59B5F8", "#3BBB96", "#3BBB96"]
  );

  const blueMainColor = ["#505050", "#505050", "#59B5F8", "#59B5F8"];
  const blueSecondaryColor = ["#A4A4A4", "#A4A4A4", "#87D9FD", "#87D9FD"];

  const purpleMainColor = ["#505050", "#505050", "#8E44EC", "#8E44EC"];
  const purpleSecondaryColor = ["#A4A4A4", "#A4A4A4", "#B382F2", "#B382F2"];

  const greenMainColor = ["#505050", "#505050", "#3BBB96", "#3BBB96"];
  const greenSecondaryColor = ["#A4A4A4", "#A4A4A4", "#75DCC0", "#75DCC0"];

  const purple1Timing = [0, 0.23, 0.23, 1];
  const purple2Timing = [0, 0.27, 0.27, 1];
  const purple3Timing = [0, 0.32, 0.32, 1];

  const blue1Timing = [0, 0.47, 0.47, 1];
  const blue2Timing = [0, 0.53, 0.53, 1];
  const green1Timing = [0, 0.66, 0.66, 1];

  return (
    <div ref={scrollTarget} className="relative w-full overflow-hidden">
      <svg
        width="1440"
        height="380"
        viewBox="0 0 1440 380"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className="w-full h-auto"
      >
        <g clipPath="url(#clip0_187_96)">
          <g className="paths">
            <path
              d="M357.5 151.5L252 207L0 62V0H1440V177L1337.5 235L1266.5 197.5L996.5 349.5L814.5 247.5L741.5 285.5L642.5 232.5L568.5 271.5L357.5 151.5Z"
              fill="#151515"
            />
            <path
              opacity="0.1"
              d="M238.848 202.075C248.416 207.599 260.201 207.613 269.782 202.113L342.038 160.63C351.001 155.485 362.027 155.498 370.978 160.666L552.998 265.755C562.589 271.293 574.407 271.293 583.998 265.755L627.498 240.641C636.471 235.461 647.526 235.461 656.498 240.641L726.09 280.821C735.681 286.358 747.498 286.358 757.09 280.821L799.348 256.423C808.32 251.243 819.375 251.243 828.348 256.423L979.999 343.979C989.59 349.517 1001.41 349.517 1011 343.979L1250.83 205.514C1259.8 200.334 1270.86 200.334 1279.83 205.514L1322.5 230.15C1332.09 235.687 1343.91 235.687 1353.5 230.15L1441 179.632V209.655L1352.5 260.75C1343.53 265.93 1332.48 265.93 1323.5 260.75L1280.83 236.114C1271.24 230.576 1259.42 230.576 1249.83 236.114L1010 374.58C1001.03 379.76 989.972 379.76 980.999 374.58L829.347 287.024C819.755 281.486 807.938 281.486 798.347 287.024L756.091 311.42C747.118 316.601 736.064 316.601 727.091 311.42L657.498 271.241C647.907 265.703 636.09 265.703 626.498 271.241L582.998 296.355C574.025 301.535 562.971 301.535 553.998 296.355L371.938 191.242C362.369 185.717 350.584 185.704 341.003 191.205L268.747 232.687C259.784 237.833 248.759 237.82 239.809 232.652L-1 93.6196V63.5981L238.848 202.075Z"
              fill="#151515"
            />
            <path
              d="M238.848 185.075C248.416 190.599 260.201 190.613 269.782 185.113L342.038 143.63C351.001 138.485 362.027 138.498 370.978 143.666L552.998 248.755C562.589 254.293 574.407 254.293 583.998 248.755L627.498 223.641C636.471 218.461 647.526 218.461 656.498 223.641L726.09 263.821C735.681 269.358 747.498 269.358 757.09 263.821L799.348 239.423C808.32 234.243 819.375 234.243 828.348 239.423L979.999 326.979C989.59 332.517 1001.41 332.517 1011 326.979L1250.83 188.514C1259.8 183.334 1270.86 183.334 1279.83 188.514L1322.5 213.15C1332.09 218.687 1343.91 218.687 1353.5 213.15L1441 162.632V192.655L1352.5 243.75C1343.53 248.93 1332.48 248.93 1323.5 243.75L1280.83 219.114C1271.24 213.576 1259.42 213.576 1249.83 219.114L1010 357.58C1001.03 362.76 989.972 362.76 980.999 357.58L829.347 270.024C819.755 264.486 807.938 264.486 798.347 270.024L756.091 294.42C747.118 299.601 736.064 299.601 727.091 294.42L657.498 254.241C647.907 248.703 636.09 248.703 626.498 254.241L582.998 279.355C574.025 284.535 562.971 284.535 553.998 279.355L371.938 174.242C362.369 168.717 350.584 168.704 341.003 174.205L268.747 215.687C259.784 220.833 248.759 220.82 239.809 215.652L-1 76.6196V46.5981L238.848 185.075Z"
              fill="#505050"
              stroke="#151515"
              strokeWidth="2"
              strokeLinecap="round"
            />
          </g>
        </g>
        <defs>
          <linearGradient
            id="paint0_linear_187_96"
            x1="1014"
            y1="193"
            x2="1014"
            y2="380"
            gradientUnits="userSpaceOnUse"
          >
            <stop stopColor="#ACACAC" />
            <stop offset="1" stopColor="#F7F7F7" />
          </linearGradient>
          <clipPath id="clip0_187_96">
            <rect width="1440" height="380" fill="white" />
          </clipPath>
        </defs>
      </svg>
    </div>
  );
};
